{% extends 'show_base.html' %}
{% block sensor_name %}
    湿度传感器
{% endblock %}

{% block head_content %}{% endblock %}

{% block div_content %}
    {{ sensor_data }}
    <div id="main" style="width: 100%;height:300px;"></div>
{% endblock %}

{% block script_content %}
    <script src="{% static 'echarts.js' %}"></script>
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        option = {
            xAxis: {
                type: 'category',
                /*
                * [ default: 'category' ]
                    坐标轴类型。

                    可选：

                    'value' 数值轴，适用于连续数据。

                    'category' 类目轴，适用于离散的类目数据，为该类型时必须通过 data 设置类目数据。

                    'time' 时间轴，适用于连续的时序数据，与数值轴相比时间轴带有时间的格式化，在刻度计算上也有所不同，例如会根据跨度的范围来决定使用月，星期，日还是小时范围的刻度。

                    'log' 对数轴。适用于对数数据
                * */
                name: '时间',
                data: ['a', 'a']
            },
            yAxis: {
                name: '摄氏度',
                type: 'value'
            },
            series: [{
                data: [820, 932, 901, 934, 1290, 1330, 1320],
                type: 'line',  // 折线图
                smooth: true,  // 平滑曲线
                itemStyle: {
                    normal: {
                        label: {
                            show: true, //开启显示
                            position: 'bottom', //在上方显示
                            textStyle: { //数值样式
                                color: 'black',
                                fontSize: 20
                            }
                        }
                    }
                }

            }]
        };
        {#myChart.showLoading();#}

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        setInterval(
            function () {
                console.log("获取数据");
                csrf_ajax.get({
                    'url': '/show/get_temp/',
                    'success': function (ret) {
                        myChart.setOption({
                            xAxis: {
                                data: ret.day
                            },
                            series: [{
                                // 根据名字对应到相应的系列
                                {#name: '销量',#}
                                data: ret.data
                            }]
                        });
                    }
                })
            },
            1000);


        {#myChart.hideLoading();#}
    </script>
{% endblock %}